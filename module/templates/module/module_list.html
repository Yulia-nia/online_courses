{% extends "C:\Users\User\PycharmProjects\online_courses\course\templates\course\base.html" %}
{% load django_bootstrap5 %}
{% bootstrap_css %}


{% block content %}
 <STYLE>
        /* Всплывающая форма-скрыта по умолчанию */
        .form-popup {
            display: none;
            position: fixed;
            bottom: 0;
            right: 15px;
            border: 3px solid #f1f1f1;
        }
 </STYLE>
    <section class="container">

    {% if announcements.count > 0 %}
        <section>
            <div class="list-group container md-3 my-3">
                {% for item, id in count_list %}

              <div class="list-group-item list-group-item-action d-flex gap-3 py-3">
{#                <img src="https://github.com/twbs.png" alt="twbs" width="32" height="32" class="rounded-circle flex-shrink-0">#}
                <div class="d-flex gap-2 w-100 justify-content-between">
                  <div>
                    <h6 class="mb-3">Объявление {{ id }}</h6>
                    <p class="mb-3 opacity-75">
                        {{ item.content | safe}}
                    </p>
                  </div>
                  <small class="opacity-50 text-nowrap">{{ item.time_update }}</small>
                </div>
              </div>
                    <hr>
                {% endfor %}
            </div>
        </section>
        <section>
            <p>Добавьте объявление ученикам</p>
            <button class="btn btn-lg position-center btn-light w-30 mx-0"
                    onclick="openForm_Announcement()">+ Добавить</button>
        </section>
    {% else %}
        <section>
            {# right #}
            <p>Добавьте объявление ученикам</p>
            <button class="btn btn-lg position-center btn-light w-30 mx-0"
                    onclick="openForm_Announcement()">+ Добавить первое объявление</button>
        </section>
    {% endif %}

    <P>HIIIIII MODULE</P>

     {% if modules.count > 0 %}
    <div class="container px-4 py-5" id="featured-3">
    <h2 class="pb-2 border-bottom">Список модулей куса</h2>
        <div class="row g-4 py-5 row-cols-1 row-cols-lg-3">

            {% for item in modules %}

        <div class="feature col">
        <div class="feature-icon bg-primary bg-gradient">
          <svg class="bi" width="1em" height="1em"></svg>
        </div>
        <h2>{{ item.title }}</h2>

                <a href="edit_module/{{ item.id }}/">Редактировать МОДУЛЬ</a>

                <h2>Кол-во уроков {{ item.lesson_set.count }}</h2>
{#            <td>#}
{#                <a href="edit_course/{{item.id}}">Управление</a> |#}
{#                <a href="delete/{{item.id}}">Удалить</a>#}
{#            </td>#}


                {% for lesson in lessons %}
                    {% if lesson.module_id == item.id %}

                        <p> {{ lesson.title }} </p>
                        <a href="edit_lesson/{{ lesson.id }}/">Редактировать урок</a>

                    {% endif %}
                {% endfor %}
{#      </div>#}

                <hr/>
                <p>Добавить</p>
{#                {% if item.lesson_set.count > 0 %}#}
{#                    <a href="#" >добавить урок</a>#}
{#                    {% else %}#}
{#                    <a href="#" >добавить первый урок</a>#}
{#                {% endif %}#}

                <a href="{{item.id}}/lesson_create/"> Урок </a> |

                <a href="#" > Задание </a>
                <p> </p>
            {% endfor %}
            </div>
        </div>
    </div>

    {% endif %}


     <button class="btn btn-lg position-center btn-light w-30 mx-0" onclick="openForm()">+ модуль</button>



      {#  FORM  announcement #}
    <div class="form-popup mb-3" id="myFormAnnouncement" >
        <div class="modal position-fixed d-block mb-lg-5 bg-body py-5"
            style="--bs-bg-opacity: .5;" tabindex="-1" role="dialog" id="modalSheet">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content rounded-6 shadow">
                    <div class="modal-header border-bottom-0">
                        <h5 class="modal-title">
                            Введите текст объявления, которое увидят участники курса
                        </h5>
                        <button type="button" class="btn-close" onclick="closeForm_Announcement()" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>

                    <div class="modal-body py-0">

                        <form method="post" action="create_announcement/" >
                             {% csrf_token %}
                             {% bootstrap_form form_announcement layout='gorizontal' %}
                            <div class="row">
                                <div class="col-6">
                                {% bootstrap_button "Опубликовать объявление" button_type="submit" button_class="btn-primary btn btn-lg w-100 mx-0" %}
                                </div>
                                <div class="col-6">
                                   <button type="button" class="btn btn-lg btn-outline-secondary w-100 mx-0" onclick="closeForm_Announcement()" data-bs-dismiss="modal">
                                        Отменить
                                   </button>
                                </div>
                            </div>

                         </form>

                    </div>
                    <div class="modal-footer flex-column border-top-0">

                    </div>
                </div>
            </div>
            </div>
        </div>



    {#  FORM ADD MODULE #}
    <div class="form-popup" id="myForm">
        <div class="modal modal-sheet position-fixed d-block bg-body py-5" style="--bs-bg-opacity: .5;" tabindex="-1" role="dialog" id="modalSheet">
            <div class="modal-dialog" role="document">
                <div class="modal-content rounded-6 shadow">
                    <div class="modal-header border-bottom-0">
                        <h5 class="modal-title">Создание курса</h5>

                        <button type="button" class="btn-close" onclick="closeForm()" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body py-0">

                        <form method="post" action="create_module/" >
                             {% csrf_token %}
                             {% bootstrap_form form layout='gorizontal' %}
                             {% bootstrap_button "Сохранить" button_type="submit" button_class="btn-primary btn btn-lg w-100 mx-0" %}
                         </form>

                    </div>
                    <div class="modal-footer flex-column border-top-0">
                        <button type="button" class="btn btn-lg btn-light w-100 mx-0" onclick="closeForm()" data-bs-dismiss="modal">Отменить</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </section>

    <script>
        function openForm() {
          document.getElementById("myForm").style.display = "block";
        }
        function closeForm() {
          document.getElementById("myForm").style.display = "none";
        }


        function openForm_Announcement() {
          document.getElementById("myFormAnnouncement").style.display = "block";
        }
        function closeForm_Announcement() {
          document.getElementById("myFormAnnouncement").style.display = "none";
        }
    </script>


{% endblock %}